# Rust MySQL TUI 工具

一个基于 Rust 和 TUI 的 MySQL 数据库管理工具，提供终端界面下的数据库浏览和数据查看功能。

## 技术栈

- **Rust**: 系统编程语言，提供高性能和内存安全
- **TUI (Terminal User Interface)**: 基于 `tui-rs` 库构建的终端用户界面
- **Crossterm**: 跨平台终端操作库，支持键盘和鼠标事件
- **MySQL**: 使用 `mysql` crate 进行数据库连接和查询
- **Serde**: 用于配置文件的序列化和反序列化
- **dirs**: 用于获取系统配置目录路径

## 主要功能

### 1. 登录功能
- 支持输入主机地址、端口、用户名和密码
- 自动保存登录凭证到配置文件
- 连接失败时显示详细错误信息
- 输入验证提示

### 2. 数据库浏览
- 显示所有可用数据库列表
- 支持键盘和鼠标操作
- 清晰的界面导航

### 3. 表管理
- 查看指定数据库中的所有表
- 显示当前数据库名称
- 快速切换和浏览

### 4. 数据查看
- 左右分栏布局：左侧显示表列表，右侧显示数据
- 表格形式展示数据，每行数据在一行内显示
- 支持上下滚动浏览数据
- 高亮显示当前选中的行
- 自动截断过长的内容以保持界面整洁

### 5. 交互方式
- 完整的键盘支持（方向键、Tab、Enter、Esc等）
- 鼠标点击和滚动支持
- 直观的界面反馈和操作提示

## 安装要求

- Rust 1.70 或更高版本
- MySQL 服务器（本地或远程）
- 支持 TUI 的终端（如 Linux 终端、Windows Terminal、macOS Terminal）

## 编译和运行

### 编译项目

```bash
cd rust_mysql
cargo build --release
```

### 运行程序

```bash
cargo run
```

或者运行编译后的可执行文件：

```bash
./target/release/rust_mysql
```

## 使用方法

### 登录界面

程序启动后，首先进入登录界面。需要输入以下信息：

1. **主机**: MySQL 服务器地址（如 `localhost` 或 `192.168.1.100`）
2. **端口**: MySQL 端口号（默认 3306）
3. **用户名**: MySQL 用户名
4. **密码**: MySQL 密码
5. **连接**: 点击或按 Enter 进行连接

#### 输入框切换方式

- **Tab**: 切换到下一个输入框
- **Shift+Tab**: 切换到上一个输入框
- **方向键 ↑/↓**: 向上/向下切换输入框
- **鼠标点击**: 直接点击输入框切换焦点
- **Enter**: 确认当前输入并跳转到下一个字段

#### 连接操作

- 在"连接"按钮上按 **Enter** 或点击鼠标进行连接
- 连接成功后自动跳转到数据库列表界面
- 连接失败会在界面底部显示红色错误提示

### 数据库列表界面

- **↑/↓** 或 **j/k**: 上下移动选择数据库
- **Enter**: 进入选中的数据库
- **Esc**: 返回登录界面
- **鼠标滚动**: 上下滚动列表

### 表列表界面

- **↑/↓** 或 **j/k**: 上下移动选择表
- **Enter**: 查看选中表的数据
- **Esc**: 返回数据库列表
- **鼠标滚动**: 上下滚动列表

### 表数据查看界面

- **左侧**: 显示当前数据库的所有表列表
- **右侧**: 显示选中表的数据
- **↑/↓** 或 **j/k**: 上下移动选择数据行
- **Esc**: 返回表列表
- **鼠标滚动**: 上下滚动数据

## 配置文件

程序会自动保存登录凭证到配置文件：

- **Linux/macOS**: `~/.config/rust_mysql/config.json`
- **Windows**: `%APPDATA%\rust_mysql\config.json`

配置文件格式（JSON）：

```json
{
  "host": "localhost",
  "port": 3306,
  "username": "root",
  "password": "your_password"
}
```

## 项目结构

```
rust_mysql/
├── Cargo.toml          # 项目配置和依赖
├── README.md           # 项目说明文档
└── src/
    ├── main.rs         # 程序入口
    ├── app.rs          # 应用状态管理
    ├── config.rs       # 配置文件处理
    ├── database.rs     # 数据库连接和查询
    ├── handlers/       # 事件处理模块
    │   ├── mod.rs
    │   ├── login.rs
    │   ├── database_list.rs
    │   ├── table_list.rs
    │   └── table_data.rs
    └── ui/              # 界面渲染模块
        ├── mod.rs
        ├── login.rs
        ├── database_list.rs
        ├── table_list.rs
        └── table_data.rs
```

## 依赖说明

- `mysql = "24.0"`: MySQL 数据库驱动
- `crossterm = "0.28"`: 跨平台终端操作
- `tui = "0.19"`: 终端用户界面库
- `serde = "1.0"`: 序列化框架
- `serde_json = "1.0"`: JSON 序列化支持
- `dirs = "5.0"`: 系统目录路径获取
- `anyhow = "1.0"`: 错误处理

## 注意事项

1. 首次连接需要输入完整的登录信息
2. 密码会以星号（*）形式显示在界面上
3. 表数据查询限制为最多 1000 行，避免数据过大导致界面卡顿
4. 过长的数据内容会自动截断显示（超过 20 个字符）
5. 确保终端支持鼠标事件，某些终端可能需要特殊配置

## 开发计划

- [ ] 支持 SQL 查询执行
- [ ] 支持数据编辑和删除
- [ ] 支持多数据库连接管理
- [ ] 支持数据导出功能
- [ ] 支持表结构查看
- [ ] 支持索引和约束信息查看

## 许可证

本项目采用 MIT 许可证。

## 贡献

欢迎提交 Issue 和 Pull Request。

